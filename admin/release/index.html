<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />

  <link rel="shortcut icon" href="assets/images/ico/favicon.ico" type="image/x-icon">
  <link rel="icon" href="assets/images/ico/favicon.ico" type="image/x-icon">
  <title>Zinkia Croupier Administrator</title>
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
 <![endif]-->  
 
  <!-- Bootstrap -->
  <link href="assets/css/bootstrap.css" rel="stylesheet" />
  <link href="assets/css/style.css" rel="stylesheet" />
  <link href="assets/css/znkcroupier.css" rel="stylesheet" />
  <link href="assets/css/datepicker.css" rel="stylesheet" media="screen">
  <link href='assets/css/fonts.css' rel='stylesheet' type='text/css'>
  <link href="assets/css/chosen.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="assets/css/datatables.css"/>
  
<!--   <link href="assets/css/bootstrap.min.css" rel="stylesheet"> -->
<!-- <link href="assets/css/style.css" rel="stylesheet"> -->
<!-- <link href="assets/css/datepicker.css" rel="stylesheet" media="screen"> -->
<!-- <link href='http://fonts.googleapis.com/css?family=Cuprum:400,400italic,700,700italic&subset=latin,latin-ext' rel='stylesheet' type='text/css'> -->
  
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<!--   <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script> 
	<script src="assets/js/lib/jquery-1.11.3.min.js"></script>-->

    <!--jQuery Core 2-->
        <script src="assets/js/lib/jquery-2.1.4.min.js" type="text/javascript"></script>


	<!-- Include all compiled plugins (below), or include individual files as needed -->
        <script src="assets/js/lib/ext-core.js"></script>
	<script src="assets/js/lib/bootstrap.min.js"></script>
	<script src="assets/js/lib/jquery.cookie.js"></script>
	<script src="assets/js/lib/md5.js"></script>
	<script type="text/javascript" src="assets/js/lib/json2.min.js"></script>
	<script type="text/javascript" src="assets/js/lib/polyfills.js"></script>
        <script src="assets/js/lib/jquery-ui.min.js"></script>
	
	
        <!-- CROUPIER REST API -->
       <!--<script type="text/javascript" src="assets/js/croupier.js"></script>-->
        <!--Data Tables-->
            
        <script type="text/javascript" src="assets/js/lib/datatables.js"></script>
        <!--/Data Tables-->
        
        <!-- Chosen v1.4.2 -->
        <script type="text/javascript" src="assets/js/lib/chosen.jquery.min.js"></script>
        <!--Defines file   @deprecated  -->
        <script type="text/javascript" src="assets/js/define.js"></script>

<body>

<header class="navbar navbar-default navbar-fixed-top" id='header'>
</header>

<!--<div class="navbar navbar-default navbar-fixed-top" id='header'>
</div>-->

<!-- <span id="nickusername_index">NICK USER index</span> -->

  <div class="container" id="main_container">
	<!--<div  class="section-tabs clearfix" id='button_open_new_tab'></div>-->
  
	<div class="section-tabs clearfix" >
	
		
              <div class="scroller scroller-left"><i class="glyphicon glyphicon-chevron-left"></i></div>
              <div class="scroller scroller-right"><i class="glyphicon glyphicon-chevron-right"></i></div>
            <div class="wrapper">
            <ul class="nav nav-tabs list" id="tabs">

            </ul>
            </div>
	</div><!--section-tabs-->
  <div class="modal fade" id="loading"> 
           <!-- <div class="modal-content">-->
                <!--<div class="alert alert-info" role="alert" style="">Loading application. Please wait.</div>-->
                <span style="position:absolute;top:30%;left:30%;color: white; font-size: 37pt; text-align: center;vertical-align: center">
                       Loading application. Please wait.
                </span>
            
      </div>
  <div class="modal fade" id="signin_form">
      <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-body">
    <form class="form-signin" name="signin_form">
      <p class="text-center">
        <img src="assets/images/html/logo-znkcroupier-big.png" alt="Zinkia Croupier" class="full-width" />
      </p>
      <p class="form-signin-heading">Please sign in</p>

      <div class="alert alert-danger" role="alert" id="info" style="display:none;"></div>
      

      <label class="sr-only">Username</label>
        <input type="text" class="form-control first" name="user" id="user" placeholder="Your username" required autofocus autocomplete="off">
      <label class="sr-only">Password</label>
        <input type="password" class="form-control" name="password" id="password" placeholder="Password" required autocomplete="off">
      <div class="mycheckbox">
        <label>
          <input type="checkbox" name="remember" id="remember" /> Remember me
       </label>
		</div> 
      <button class="btn btn-lg btn-primary btn-block" id="signin_button" type="submit">Sign in</button>

    </form>
  </div>
  </div> 
</div></div></div>
<template name="errorMessage">

 <div id="{id}" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-body">
                <div id="{id}_alert" class="alert alert-danger alert-dismissible fade in" role="alert">
                    
                    <!--<button type="button" class="close" data-dismiss="alert" aria-label="Close">
                    <span aria-hidden="true">Ã—</span></button> -->
                    
                    <h4>{title}</h4> 
                    <p>{message}</p> 
                    <p style="text-align: right"><button type="button" class="btn btn-danger" data-dismiss="alert" aria-label="Close">OK</button></p> 
                </div>
        </div> 
    </div>
  </div>
</div>

</template>

<template name="progressBox">
    
  <div id="{id}" class="modal fade" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-body">
                <div id="{id}_alert" class="alert alert-success alert-dismissible fade in" role="alert">
                    
                    <h3>{title}</h3>
                    <hr class="bordered"/>
                    <p class="center-block msg" style="text-align: center">{message}</p><br /> 
                    <div class="progress center-block">
                        <div class="progress-bar progress-bar-success progress-bar-striped active" id="{id}_progress" style="width: {progress}%">
                            <span>{progress}%</span>
                        </div>
                      <!--<progress id="{id}_progress" value="{progress}" max="100">{progress} %</progress>-->
                      
                    </div>
                    <p style="text-align: right">
                        <button type="button" class="btn btn-danger {noabort}" data-dismiss="alert" aria-label="Close">
                            Abort
                        </button>
                        <button type="button" class="btn btn-danger" data-dismiss="modal" aria-label="Close">
                            Close
                        </button>
                    </p>
                </div>
        </div> 
    </div>
  </div>
</div>
     
</template>

<!--<template name="about">-->
<!--modal #about-znkcroupier-->
<div class="modal fade" id="about-znkcroupier" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-sm">
    <div class="modal-content">
      <div class="modal-body">
      	<p class="text-center">
      		<img src="assets/images/html/logo-znkcroupier-big.png" alt="Zinkia Croupier" class="full-width" />
      	</p>
      	<p id="appName"></p>
      	<p>Zinkia Entertainment</p>
      </div>
    </div>
  </div>
</div>
<!--</template>-->
<!--/modal #about-znkcroupier-->


  <script>
  
	
    $(function()
    {
       
       
        
	Ext.onReady(function() {
            Ext.ns("App");    
            
         
         App.onReady = function() {
                    
                     
                      
                     Ext.apply(App, new App.Bootstrap({
                                                config: "config.json",
                                                adminConfig: "admin_config.json"
                                             }));
                                             
                                             
                                             
        
                     console.info("[App] System ready.");
                 
                 App.onLoad = function(config) {
                    $('#loading').fadeOut("slow")
                                 .modal("hide");
                         
                         
                    
                    
                    
                    App.mainBox.done();
                    
                    $("#signin_button").removeClass("disabled").removeAttr("disabled");
                                                         
                    App.config = config;
                    
                    $.fx.off = !config.animations;
                    
                    Ext.apply(App.config,C);//TODO: migrar defines a config
                    console.info("[App.onLoad] Loading widget templates...");
                    
                     App.loadTemplates();   
                     
                    console.info("[App.onLoad] App loaded.");
                    
                    
                    console.info("[App.onLoad] Waiting for login...");
                
                    
                 
                 if (App.config.debug) {
                     
                     App.load("assets/js/lib/log4javascript.js",function() {
                        log4javascript.getRootLogger().addAppender(new log4javascript.PopUpAppender());
                     });
                     
                     $("<style>").attr("type","text/css").text(".debug {display:block}").appendTo($("head"));
                 } else {
                     $("<style>").attr("type","text/css").text(".debug {display:none}").appendTo($("head"));
                     
                     window.console = { //console func stubs
                         log: function() {},
                         debug:function() {},
                         warn:function() {},
                         info:function() {},
                         dir:function() {},
                         error:function() {}
                     };
                     
                 }
                 
                 
                 App.user = new App.Croupier.User();
                 console.info("[App] Waiting for login.");
                 $( "#signin_form" )
                        .modal({backdrop:"static"}).fadeIn('slow');
                $("#appName").text(App.getAppName());
               
              App.user.on("loginsuccess",function(ev) {
                  console.info("[App.User] Login Success.");
                  
                  $("#signin_button").attr("disabled","disabled").addClass("disabled").off("click");
                $( "#signin_form" ).fadeOut();$( "#info" ).hide();
                                                   
                try {
                
                console.info("[App] Loading layout");
                
                 if (croupier.$allEventReceived) {
                     croupier.$allEventReceived = false;
                     
                 }  else {this.load_layout();}
                $("body").removeClass("modal-open"); //FIXME: HACK. Corregir CSS del bootstrap.
                
                console.info("[App] Initiating croupier.data() update layout");
                
                
                this.init_star();
                
               /* App.tabs.on("dataupdate",function(resp) {
                     console.log("[Tabs: ondataupdate()]");
                     console.dir(resp);
                     this.tab_active.update();
                },App.tabs);*/
                $('#logout').click(function(e) 
                {
                    e.preventDefault();
                    App.user.logout();
                    
	
                });
              } catch(e) {
                 if (App.config.debug) {
                    // App.errorMsg("[DEBUG] Internal Error:",e);
                 } else {
                     console.error(e);
                 }
                     
              }
             },App.user); //OnLoginSuccess
             
             
             App.user.on("loginerror",function(resp) {
                    App.errorMsg("Login Error",resp.value,function() {location.reload();});
                    
                 
             },App.user);
             
             $(document).ajaxSuccess(function(e,xhr,opts) {
                 if (opts.url=="api/auth/login" || !xhr.responseJSON) return;
                 var resp =xhr.responseJSON;
                if(resp.status == croupier.ResponseStatus.UNAUTHORIZED && opts.url =="api/modification/list") {
                    
                    
                    App.mainBox =App.progressMsg(App.getAppName(),"Your session has expired. Trying to relogin...",function() {location.reload();});
                    
                    App.user.on("loginsuccess",function() {
                        id = App.mainBox.id;
                        App.mainBox.progress(100);
                        App.mainBox.done();
                        
                        window.setTimeout(function() {$("#"+id).remove();},2000);
                    })
                    
                    App.user.login();
                    
                } 
                 
                 
                else if (resp.status != croupier.ResponseStatus.SUCCESS) { 
                     App.errorMsg(
                             "Croupier API Error ("+opts.url+")",
                             "Response status: "+croupier.ResponseStatus.__names__[resp.status]+"<br/>Error message: "+resp.value);
                } 
                 
             });
             
             $(document).ajaxError(function(e,xhr,opts,error) {
                 //console.dir(opts.xhr());
                var box = App.errorMsg("Server Communication Error",error+"<br/>Reconnection in <span id='countdown'>5</span> seconds...",function() {App.__noreconnect =true;});
                 
                 
                     var sec=5;
                     function reconnect() {
                         box.remove();
                         if (App.__noreconnect) return;
                         
                            App.user.init_star();
                     }
                     function countDown(n) {
                         
                         $("#countdown").text(n);
                     }
                     
                     reconnect.defer(sec*1000);
                     
                     for (i=sec;i>=0;i--)
                     {
                        countDown.defer((sec-i)*1000,this,[i]);
                     }
                     
                     
                     //location.reload();
                 
             });
             
             
           } //end App.onLoad   
             
                     
                     
        } //end App.onReady
     
     $('#loading').modal({backdrop:"static"}).fadeIn('slow');
     
     
     $.getScript("assets/js/app.js",App.onReady);
         //   $.getScript(App.config.jsDir+"/"+App.config.definesFile);
      
       
    });
  
    });
  </script>

  
  
</body>
</html>
